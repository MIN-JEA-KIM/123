<!DOCTYPE html>
{% load static %}
<html lang="zxx">
  <head>
    <!-- Required meta tags -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>World Vision</title>
    <!-- plugin css for this page -->
    <link
      rel="stylesheet"
      href="{% static 'assets/vendors/mdi/css/materialdesignicons.min.css' %}"
    />
    <link rel="stylesheet" href="{% static 'assets/vendors/aos/dist/aos.css/aos.css' %}" />
    <link
      rel="stylesheet"
      href="{% static 'assets/vendors/owl.carousel/dist/assets/owl.carousel.min.css' %}"
    />
    <link
      rel="stylesheet"
      href="{% static 'assets/vendors/owl.carousel/dist/assets/owl.theme.default.min.css' %}"
    />
    <!-- End plugin css for this page -->
    <link rel="shortcut icon" href="{% static 'assets/images/favicon.png' %}" />
    <!-- inject:css -->
    <link rel="stylesheet" href="{% static 'assets/css/style.css' %}">
    <!-- endinject -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script type="text/javascript">
      $(".recommend").click(function () { // .recommend 버튼을 클릭 감지
        var pk = $(this).attr('name')
        $.ajax({ // ajax로 서버와 통신
            type: "POST", // 데이터를 전송하는 방법
            url: "{% url 'recommend' %}", // 통신할 url을 지정
            data: { 'pk': pk, 'csrfmiddlewaretoken': '{{ csrf_token }}' }, 
            dataType: "json",
            success: function (response) { // 성공
                alert(response.message);
                $("#count-" + pk).html("추천&nbsp;" + response.recommend_count + "개"); 
            },
            error: function (request, status, error) { // 실패
                alert("로그인이 필요합니다.")
                window.location.replace("/video/login/") // 로그인 페이지로 넘어가기
            },
        });
      })

      function showClock(){
        var currentDate = new Date();
        var divClock = document.getElementById('divClock');
        var msg = "";
        if(currentDate.getHours()>12){
          msg += "오후 ";
          msg += currentDate.getHours()-12+"시 ";
       }
       else {
         msg += "오전 ";
         msg += currentDate.getHours()+"시 ";
       }

        msg += currentDate.getMinutes()+"분 ";

        divClock.innerText = msg;

        if (currentDate.getMinutes()>58) {
          divClock.style.color="red";
        }
        setTimeout(showClock,1000);
      }
    </script>
  </head>

  <body onload="showClock()">
    <div class="container-scroller">
      {% include '_navbar.html' %}
      <div class="container">
        <div class="row">
          <div class="col-sm-12">
            <div class="text-left">
              <div class="row justify-content-between align-items-center navbar-top">
                <h1 class="font-weight-600 mt-5">
                  {{ news.n_title }}
                </h1>
                <h7 class="font-weight-600 mt-3">
                  <a href='{{ news.o_link }}' style="color:blue;">원본링크</a>
                </h7>
              </div>
              <br>
                <img src="{{ news.nd_img }}" class="img-fluid2" alt="world-news"/>
                <div class="d-flex flex-column justify-content-between align-items-center navbar-top" style="line-height: 200%">
                  <h3>요약문</h3>
                  <br>

                  {% for nsc in ns_content %}
                    {{ nsc }} <br><br>
                  {% endfor %}
                  
                  <br>
                </div>
                <br>  
                <br>
                <div class="d-flex flex-column justify-content-between align-items-center navbar-top" style="line-height: 200%">
                  <h3>원문</h3>
                  <br>
                  {% for nc in n_content %}
                    {{ nc }} <br><br>
                  {% endfor %}
                  <br>
                </div>
                <br>   
                <!-- 조회수 -->
                {% csrf_token %}
                조회수: {{article.hits}}
                <br>
                <!-- 추천 -->
                <div>
                  <input type="button" class="btn btn-info btn-sm recommend" name="{{ n_rec.id }}" value="추천"
                      style="margin-top: 7px">
                  <p id="count-{{n_rec.id }}" style="font:bold 1em; margin-top: 3px">
                      추천&nbsp;{{ n_rec.recommend.all.count }}개</p>
                </div>
          </div>
        </div>
      </div>
    </div>
    <!-- container-scroller ends -->
    <!-- partial:../partials/_footer.html -->
    {% include '_footer.html' %}

    <!-- partial -->
    <!-- inject:js -->
    <script src="{% static 'assets/vendors/js/vendor.bundle.base.js' %}"></script>
    <!-- endinject -->
    <!-- plugin js for this page -->
    <script src="{% static 'assets/vendors/aos/dist/aos.js/aos.js' %}"></script>
    <script src="{% static 'assets/vendors/owl.carousel/dist/owl.carousel.min.js' %}"></script>
    <!-- End plugin js for this page -->
    <!-- Custom js for this page-->
    <script src="{% static 'assets/js/demo.js' %}"></script>
    <!-- End custom js for this page-->
  </body>
</html>
